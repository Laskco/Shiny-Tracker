<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHINY TRACKER - Retro Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #212121;
            --bg-card: #c0c0c0;
            --text-color: #000000;
            --border-light: #dfdfdf;
            --border-dark: #656565;
            --title-bar-bg: #000080;
            --title-bar-text: #ffffff;
            
            --yellow: #ffff00;
            --cyan: #00ffff;
            --magenta: #ff00ff;
            --red: #ff0000;
            --green: #00ff00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
        }

        body {
            font-family: 'Press Start 2P', cursive;
            background-color: var(--bg-body);
            color: var(--text-color);
            padding: 20px;
            line-height: 1.5;
            font-size: 16px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(rgba(255,255,255,0.05) 2px, transparent 2px);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 1000;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            min-height: 0; 
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            border: 2px solid var(--border-dark);
            border-top-color: var(--border-light);
            border-left-color: var(--border-light);
            background: var(--bg-card);
            flex-shrink: 0; 
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--text-color);
            text-shadow: 2px 2px var(--border-dark);
        }

        .header p {
            font-size: 0.8rem;
            color: var(--text-color);
        }

        .main-grid {
            display: grid;
            gap: 20px;
            flex-grow: 1;
            min-height: 0;
        }

        @media (min-width: 1024px) {
            .main-grid {
                grid-template-columns: 350px 1fr 1fr;
                grid-template-rows: auto auto 1fr;
                grid-template-areas:
                    "pokedex counter counter"
                    "pokedex auto-counter hunt-timer"
                    "pokedex history history";
            }
             #pokedex-card { grid-area: pokedex; }
             #counter-card { grid-area: counter; }
             #auto-counter-card { grid-area: auto-counter; }
             #hunt-timer-card { grid-area: hunt-timer; }
             #history-card { grid-area: history; }
        }

        .card {
            background: var(--bg-card);
            border: 2px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            padding: 3px;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .card-content {
            padding: 15px;
            border: 2px solid;
            border-color: #888 #fff #fff #888;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            min-height: 0; 
        }

        .card-title {
            font-size: 1rem;
            padding: 5px 10px;
            background: var(--title-bar-bg);
            color: var(--title-bar-text);
            margin-bottom: 0;
            text-transform: uppercase;
            flex-shrink: 0;
        }
        
        hr.retro {
            border: none;
            border-top: 2px solid var(--border-dark);
            border-bottom: 2px solid var(--border-light);
            margin: 20px 0;
        }

        .pokemon-display {
            text-align: center;
            background: #000;
            padding: 15px;
            border: 2px inset var(--border-dark);
            margin-bottom: 15px;
        }

        .pokemon-sprite {
            width: 128px;
            height: 128px;
            image-rendering: pixelated;
            margin: 10px auto;
            transform: scale(1.5);
        }

        .pokemon-name {
            font-size: 1.5rem;
            margin: 15px 0 5px 0;
            color: var(--green);
        }

        .pokemon-id {
            font-size: 1rem;
            color: var(--green);
            margin-bottom: 15px;
        }

        .badge {
            display: inline-block;
            padding: 8px 12px;
            border: 2px solid var(--text-color);
            font-size: 0.6rem;
            margin: 8px 4px 0 4px;
            text-transform: uppercase;
        }

        .badge-danger { background: var(--red); color: #fff; }
        .badge-warning { background: var(--yellow); color: var(--text-color); }
        .badge-info { background: var(--cyan); color: var(--text-color); }

        .search-input, .method-select, .timer-input {
            width: 100%;
            padding: 10px;
            background: var(--border-light);
            border: 2px solid;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            color: var(--text-color);
            font-size: 0.8rem;
            font-family: 'Press Start 2P', cursive;
        }
        
        .search-input:focus, .method-select:focus, .timer-input:focus {
            outline: 2px dotted var(--title-bar-bg);
            outline-offset: -2px;
        }

        #pokedex-card .card-content {
            padding: 10px;
        }
        
        .pokedex-selector {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            min-height: 0;
        }
        
        .pokemon-list {
            overflow-y: auto;
            border: 2px solid;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            padding: 5px;
            flex-grow: 1;
            background: var(--border-light);
            margin-top: 15px;
            max-height: 550px;
        }
        
        .pokemon-list::-webkit-scrollbar { width: 16px; }
        .pokemon-list::-webkit-scrollbar-track { background: var(--bg-card); }
        .pokemon-list::-webkit-scrollbar-thumb { background: var(--border-dark); border: 2px solid var(--bg-card); }

        .pokemon-item {
            padding: 8px 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
            font-size: 0.8rem;
            margin-bottom: 2px;
        }
        .pokemon-item:hover { background: rgba(0,0,0,0.1); }
        .pokemon-item.selected { background: var(--title-bar-bg); color: var(--title-bar-text); }
        
        .counter-card { text-align: center; }

        .counter-value {
            font-size: 4rem;
            color: var(--text-color);
            margin: 20px 0;
            line-height: 1;
            background: #000;
            color: var(--yellow);
            padding: 20px;
            border: 2px inset var(--border-dark);
        }

        .counter-label {
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .btn-group.three-buttons { grid-template-columns: repeat(3, 1fr); }
        
        .btn {
            padding: 12px 15px;
            font-size: 0.8rem;
            border: 2px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            background-color: var(--bg-card);
            transition: none;
        }
        .btn:active:not(:disabled) {
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            transform: translate(1px, 1px);
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-full { grid-column: 1 / -1; }

        #hunt-timer-display {
            font-size: 2rem;
            text-align: center;
            margin: 20px 0;
            background: #000;
            color: var(--cyan);
            padding: 15px;
            border: 2px inset var(--border-dark);
        }
        
        .timer-countdown {
            font-size: 1rem;
            font-weight: 700;
            color: var(--magenta);
        }

        .odds-info {
            display: grid;
            gap: 15px;
            margin-top: 20px;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }

        .odds-stat {
            background: var(--bg-card);
            padding: 15px;
            border: 2px inset var(--border-dark);
        }
        .odds-stat-label {
            font-size: 0.7rem;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        .odds-stat-value { font-size: 1.2rem; }

        .method-select option { background: #fff; color: #000; }

        .history-list { max-height: 300px; overflow-y: auto; }
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border: 2px inset var(--border-dark);
            margin-bottom: 10px;
            gap: 10px;
        }
        .history-pokemon { font-size: 0.8rem; }
        .history-count { color: var(--title-bar-bg); font-size: 1rem; }
        
        .delete-hunt-btn {
            background: var(--bg-card);
            color: var(--red);
            border: 2px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            flex-shrink: 0;
            padding: 0;
            line-height: 1;
        }
        .delete-hunt-btn:active {
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
        }

        .alert { 
            padding: 15px; 
            margin-top: 15px; 
            font-size: 0.7rem;
            border: 2px solid;
        }
        .alert-danger { border-color: var(--red); color: var(--red); }
        .alert-warning { border-color: var(--yellow); color: var(--yellow); }

        .success-message {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 25px;
            background: var(--green);
            color: var(--text-color);
            border: 2px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            z-index: 1000;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .loading { text-align: center; padding: 40px; font-size: 0.8rem; }
        .spinner { display: none; /* No spinners in the 90s */ }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-size: 0.8rem;
        }

        .donation-section {
            margin-top: auto;
            padding-top: 15px;
            border-top: 2px solid var(--border-dark);
            text-align: center;
        }

        .donation-section h4 {
            font-size: 0.8rem;
            margin-bottom: 10px;
            color: var(--title-bar-bg);
        }

        .donation-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .donation-btn {
            display: inline-block;
            padding: 10px 15px;
            background: var(--border-light);
            border: 2px solid;
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            color: var(--text-color);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            text-decoration: none;
            text-align: center;
            transition: none;
        }

        .donation-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .donation-btn:active {
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
            transform: translate(1px, 1px);
        }

        @media (max-width: 600px) {
            body { padding: 10px; font-size: 14px; }
            .header h1 { font-size: 1.5rem; }
            .counter-value { font-size: 3rem; }
            .btn-group.three-buttons, .btn-group { grid-template-columns: 1fr; }
            .card-content { padding: 10px; }
            .pokemon-list {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>SHINY TRACKER</h1>
            <p>v.1996</p>
        </header>

        <main class="main-grid">
            
            <div class="card" id="pokedex-card">
                <h3 class="card-title">POKEDEX.EXE</h3>
                <div class="card-content">
                    <div class="pokemon-display">
                        <img id="pokemon-sprite" class="pokemon-sprite" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/shiny/6.png" alt="Shiny Pokemon">
                        <h2 id="pokemon-name" class="pokemon-name">Charizard</h2>
                        <div id="pokemon-id" class="pokemon-id">#006</div>
                        <div id="badges-container"></div>
                    </div>
                    <div class="pokedex-selector">
                        <div class="search-container">
                            <input type="text" id="pokemon-search" class="search-input" placeholder="SEARCH...">
                        </div>
                        <div id="pokemon-list" class="pokemon-list">
                            <div class="loading">LOADING...</div>
                        </div>
                        <div class="donation-section">
                            <h4>SUPPORT DEVELOPMENT</h4>
                            <div class="donation-links">
                                <a href="https://buymeacoffee.com/laskco" target="_blank" class="donation-btn">BUY ME A COFFEE</a>
                                <a href="https://www.paypal.com/donate/?hosted_button_id=R87TNQANCT8KN" target="_blank" class="donation-btn">DONATE VIA PAYPAL</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card" id="counter-card">
                 <h3 class="card-title">CONTROL_PANEL.EXE</h3>
                 <div class="card-content">
                    <div class="counter-label">TOTAL ENCOUNTERS</div>
                    <div id="counter" class="counter-value">0</div>
                    <div class="btn-group">
                        <button id="increment-btn" class="btn btn-full">+1</button>
                        <button id="reset-btn" class="btn">RESET</button>
                        <button id="save-hunt-btn" class="btn">SAVE</button>
                    </div>

                    <hr class="retro">
                    
                    <label>GAME/GEN:</label>
                    <select id="generation-select" class="method-select">
                        <option value="gen9-za">Gen 9 - Legends: Z-A</option>
                        <option value="gen9">Gen 9 - Scarlet & Violet</option>
                        <option value="gen8-pla">Gen 8 - Legends: Arceus</option>
                        <option value="gen8-swsh">Gen 8 - Sword & Shield</option>
                        <option value="gen8-bdsp">Gen 8 - BDSP</option>
                        <option value="gen7-lgpe">Let's Go Pikachu/Eevee</option>
                        <option value="gen7">Gen 7 - Sun/Moon/USUM</option>
                        <option value="gen6">Gen 6 - X/Y/ORAS</option>
                        <option value="gen5">Gen 5 - BW/B2W2</option>
                        <option value="gen4">Gen 4 - DPPt/HGSS</option>
                        <option value="gen3">Gen 3 - RSE/FRLG</option>
                        <option value="gen2">Gen 2 - GSC</option>
                    </select>

                    <label style="margin-top:15px;">HUNT METHOD:</label>
                    <select id="hunt-method" class="method-select">
                        <option value="4096">Random Encounter (1/4096)</option>
                    </select>

                    <div class="odds-info">
                        <div class="odds-stat">
                            <div class="odds-stat-label">ODDS</div>
                            <div id="odds-rate" class="odds-stat-value">1/4096</div>
                        </div>
                        <div class="odds-stat">
                            <div class="odds-stat-label">PROBABILITY</div>
                            <div id="odds-cumulative" class="odds-stat-value">0.00%</div>
                        </div>
                        <div class="odds-stat">
                            <div class="odds-stat-label">50% AT</div>
                            <div id="odds-median" class="odds-stat-value">2839</div>
                        </div>
                    </div>
                    <div id="odds-alerts"></div>
                </div>
            </div>

            <div class="card" id="auto-counter-card">
                <h3 class="card-title">AUTO_CNT.EXE</h3>
                <div class="card-content">
                    <label>AUTO EVERY (SECS):</label>
                    <input type="number" id="timer-interval" class="timer-input" value="30" min="1" max="999">
                    <div class="btn-group">
                        <button id="start-timer-btn" class="btn">START</button>
                        <button id="stop-timer-btn" class="btn" disabled>STOP</button>
                    </div>
                </div>
            </div>

            <div class="card" id="hunt-timer-card">
                <h3 class="card-title">TIMER.EXE</h3>
                <div class="card-content">
                    <div id="hunt-timer-display">00:00:00</div>
                    <div class="btn-group three-buttons">
                        <button id="start-hunt-timer-btn" class="btn">START</button>
                        <button id="pause-hunt-timer-btn" class="btn" disabled>PAUSE</button>
                        <button id="reset-hunt-timer-btn" class="btn">RESET</button>
                    </div>
                </div>
            </div>

            <div class="card" id="history-card">
                <h3 class="card-title">HISTORY.DAT</h3>
                <div class="card-content">
                    <div id="hunt-history" class="history-section">
                        <p>NO SAVED HUNTS.</p>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        let encounterCount = 0;
        let allPokemon = [];
        let currentPokemon = { name: 'charizard', id: 6 };
        let huntHistory = [];
        
        let timerInterval = null;
        let countdownInterval = null;
        let countdownValue = 0;

        let huntTimerInterval = null;
        let huntTimeSeconds = 0;
        let isHuntTimerRunning = false;

        const shinyLockedPokemon = { 'mew': 'Gen 2 (IVs prevent shiny)', 'celebi': 'Gen 3-7', 'manaphy': 'Gen 4 (Egg)', 'arceus': 'Gen 4-5', 'victini': 'Gen 5-7', 'reshiram': 'Gen 5', 'zekrom': 'Gen 5', 'keldeo': 'Gen 5-8', 'meloetta': 'Gen 5-7', 'groudon': 'Gen 6 ORAS Story', 'kyogre': 'Gen 6 ORAS Story', 'rayquaza': 'Gen 6 ORAS Story', 'zygarde': 'Gen 6-7', 'hoopa': 'Gen 6-7', 'volcanion': 'Gen 6-7', 'tapu-koko': 'Gen 7', 'tapu-lele': 'Gen 7', 'tapu-bulu': 'Gen 7', 'tapu-fini': 'Gen 7', 'cosmog': 'Gen 7-8', 'cosmoem': 'Gen 7', 'solgaleo': 'Gen 7-9', 'lunala': 'Gen 7-9', 'nihilego': 'Gen 7', 'buzzwole': 'Gen 7', 'pheromosa': 'Gen 7', 'xurkitree': 'Gen 7', 'celesteela': 'Gen 7', 'kartana': 'Gen 7', 'guzzlord': 'Gen 7', 'necrozma': 'Gen 7-9', 'magearna': 'Gen 7', 'marshadow': 'Gen 7', 'zeraora': 'Gen 7', 'pikachu': 'Gen 8 LGPE Starter / SwSh Gift', 'eevee': 'Gen 8 LGPE Starter / SwSh Gift', 'grookey': 'Gen 8 SwSh Starter', 'scorbunny': 'Gen 8 SwSh Starter', 'sobble': 'Gen 8 SwSh Starter', 'type-null': 'Gen 8 SwSh', 'silvally': 'Gen 8 SwSh', 'zacian': 'Gen 8 SwSh', 'zamazenta': 'Gen 8 SwSh', 'eternatus': 'Gen 8 SwSh', 'kubfu': 'Gen 8-9', 'urshifu': 'Gen 8 IoA', 'zarude': 'Gen 8 IoA', 'calyrex': 'Gen 8 CT', 'glastrier': 'Gen 8-9', 'spectrier': 'Gen 8-9', 'melmetal': 'Gen 8 Gigantamax', 'poipole': 'Gen 8 CT', 'articuno-galar': 'Gen 8 CT', 'zapdos-galar': 'Gen 8 CT', 'moltres-galar': 'Gen 8 CT', 'jirachi': 'Gen 8 BDSP Gift', 'rowlet': 'Gen 8 PLA Starter', 'cyndaquil': 'Gen 8 PLA Starter', 'oshawott': 'Gen 8 PLA Starter', 'uxie': 'Gen 8 PLA', 'mesprit': 'Gen 8 PLA', 'azelf': 'Gen 8 PLA', 'dialga': 'Gen 8 PLA', 'palkia': 'Gen 8 PLA', 'heatran': 'Gen 8 PLA', 'regigigas': 'Gen 8 PLA', 'giratina': 'Gen 8 PLA', 'cresselia': 'Gen 8 PLA', 'phione': 'Gen 8 PLA', 'darkrai': 'Gen 8 PLA', 'shaymin': 'Gen 8 PLA', 'tornadus': 'Gen 8 PLA', 'thundurus': 'Gen 8 PLA', 'landorus': 'Gen 8 PLA', 'enamorus': 'Gen 8 PLA', 'sprigatito': 'Gen 9 SV/ZA Starter', 'fuecoco': 'Gen 9 SV/ZA Starter', 'quaxly': 'Gen 9 SV/ZA Starter', 'koraidon': 'Gen 9 SV', 'miraidon': 'Gen 9 SV', 'klawf': 'Gen 9 SV Titan', 'bombirdier': 'Gen 9 SV Titan', 'orthworm': 'Gen 9 SV Titan', 'great-tusk': 'Gen 9 SV Titan', 'iron-treads': 'Gen 9 SV Titan', 'tatsugiri': 'Gen 9 SV Titan', 'ting-lu': 'Gen 9 SV', 'chien-pao': 'Gen 9 SV', 'wo-chien': 'Gen 9 SV', 'chi-yu': 'Gen 9 SV', 'walking-wake': 'Gen 9 SV Event Raid', 'iron-leaves': 'Gen 9 SV Event Raid', 'bloodmoon-ursaluna': 'Gen 9 Teal Mask', 'okidogi': 'Gen 9 Teal Mask', 'munkidori': 'Gen 9 Teal Mask', 'fezandipiti': 'Gen 9 Teal Mask', 'ogerpon': 'Gen 9 Teal Mask', 'terapagos': 'Gen 9 Indigo Disk', 'pecharunt': 'Gen 9 Indigo Disk', 'gouging-fire': 'Gen 9 Indigo Disk', 'raging-bolt': 'Gen 9 Indigo Disk', 'iron-crown': 'Gen 9 Indigo Disk', 'iron-boulder': 'Gen 9 Indigo Disk', 'articuno': 'Gen 9 Indigo Disk', 'zapdos': 'Gen 9 Indigo Disk', 'moltres': 'Gen 9 Indigo Disk', 'raikou': 'Gen 9 Indigo Disk', 'entei': 'Gen 9 Indigo Disk', 'suicune': 'Gen 9 Indigo Disk', 'lugia': 'Gen 9 Indigo Disk', 'ho-oh': 'Gen 9 Indigo Disk', 'latias': 'Gen 9 Indigo Disk', 'latios': 'Gen 9 Indigo Disk', 'cobalion': 'Gen 9 Indigo Disk', 'terrakion': 'Gen 9 Indigo Disk', 'virizion': 'Gen 9 Indigo Disk', 'kyurem': 'Gen 9 Indigo Disk', 'chikorita': 'Gen 9 Z-A Starter', 'tepig': 'Gen 9 Z-A Starter', 'totodile': 'Gen 9 Z-A Starter', 'absol': 'Gen 9 Z-A (Rogue Mega)' };
        const gen9SVTrades = ['snom', 'wooper', 'haunter', 'gengar', 'meowth-galar'];
        const gen9TealMaskGifts = ['growlithe-hisui', 'turtwig', 'chimchar', 'piplup'];
        const gen9IndigoDiskTrades = [ 'magby', 'dunsparce', 'wooper-paldea', 'pawmo', 'cetoddle', 'veluza', 'frigibax', 'combee', 'duraludon', 'meditite', 'sunflora', 'magnemite', 'mareanie', 'skarmory', 'glimmet', 'tinkatuff', 'greavard', 'gimmighoul', 'flittle', 'hattrem', 'meowth-alola', 'snubbull', 'gulpin', 'tauros-paldea', 'eevee', 'rockruff', 'skwovet', 'applin', 'poltchageist' ];
        const gen9SevenStarRaids = [ 'charizard', 'cinderace', 'greninja', 'pikachu', 'decidueye', 'samurott', 'typhlosion', 'inteleon', 'chesnaught', 'delphox', 'rillaboom', 'mewtwo', 'decidueye-hisui', 'typhlosion-hisui', 'eevee', 'samurott-hisui', 'dialga', 'palkia', 'blaziken', 'empoleon', 'venusaur', 'blastoise', 'meganium', 'primarina', 'swampert', 'emboar', 'sceptile', 'dondozo', 'dragonite', 'incineroar', 'serperior', 'infernape', 'feraligatr', 'torterra', 'meowscarada', 'skeledirge', 'quaquaval', 'tyranitar', 'salamence', 'metagross', 'garchomp', 'porygon2', 'baxcalibur', 'kommo-o', 'roaring-moon', 'iron-valiant' ];
        const gen9SVStaticLocks = [ 'sprigatito', 'floragato', 'meowscarada', 'fuecoco', 'crocalor', 'skeledirge', 'quaxly', 'quaxwell', 'quaquaval' ];
        const gen9ZAStaticLocks = [ 'chikorita', 'bayleef', 'meganium', 'totodile', 'croconaw', 'feraligatr', 'tepig', 'pignite', 'emboar', 'absol' ];

        const counterEl = document.getElementById('counter');
        const spriteEl = document.getElementById('pokemon-sprite');
        const nameEl = document.getElementById('pokemon-name');
        const idEl = document.getElementById('pokemon-id');
        const badgesEl = document.getElementById('badges-container');
        const searchEl = document.getElementById('pokemon-search');
        const listEl = document.getElementById('pokemon-list');
        const generationEl = document.getElementById('generation-select');
        const methodEl = document.getElementById('hunt-method');
        const oddsRateEl = document.getElementById('odds-rate');
        const oddsCumulativeEl = document.getElementById('odds-cumulative');
        const oddsMedianEl = document.getElementById('odds-median');
        const oddsAlertsEl = document.getElementById('odds-alerts');
        const timerIntervalEl = document.getElementById('timer-interval');
        const historyEl = document.getElementById('hunt-history');
        const huntTimerDisplayEl = document.getElementById('hunt-timer-display');
        const startHuntTimerBtn = document.getElementById('start-hunt-timer-btn');
        const pauseHuntTimerBtn = document.getElementById('pause-hunt-timer-btn');
        const resetHuntTimerBtn = document.getElementById('reset-hunt-timer-btn');

        const huntMethods = { 'gen9-za': [ { value: '4096', label: 'Wild Encounter (Base)' }, { value: '1024.3', label: 'Wild Encounter + Shiny Charm (+3 rolls!)' }, { value: '4096', label: 'Fossil Encounter (NO Charm boost!)' } ], 'gen9': [ { value: '4096', label: 'Random Encounter' }, { value: '1365', label: 'Shiny Charm' }, { value: '2048', label: 'Outbreak (30-59 cleared)' }, { value: '1024', label: 'Outbreak (30-59) + Charm' }, { value: '1365', label: 'Outbreak (60+ cleared)' }, { value: '819', label: 'Outbreak (60+) + Charm' }, { value: '1024', label: 'Sparkling Power Lv. 3' }, { value: '683', 'label': 'Sparkling Lv. 3 + Charm' }, { value: '819', label: 'Outbreak (30-59) + Sparkling Lv. 3' }, { value: '585', label: 'Outbreak (30-59) + Sparkling + Charm' }, { value: '683', label: 'Outbreak (60+) + Sparkling Lv. 3' }, { value: '512', label: 'BEST: Outbreak (60+) + Sparkling + Charm' }, { value: '683', label: 'Masuda Method' }, { value: '512', label: 'Masuda Method + Charm' }, { value: '4103', label: 'Tera Raids' } ], 'gen8-pla': [ { value: '4096', label: 'Base Odds' }, { value: '2048', label: 'Research Level 10' }, { value: '1024', label: 'Perfect Research' }, { value: '819', label: 'Level 10 + Shiny Charm' }, { value: '585', label: 'Perfect + Shiny Charm' }, { value: '158', label: 'Mass Outbreak' }, { value: '152', label: 'Outbreak + Level 10' }, { value: '142', label: 'Outbreak + Perfect' }, { value: '137', label: 'Outbreak + Level 10 + Charm' }, { value: '128', label: 'BEST: Outbreak + Perfect + Charm' } ], 'gen8-swsh': [ { value: '4096', label: 'Random Encounter' }, { value: '1365', label: 'Shiny Charm' }, { value: '2048', label: 'Brilliant (1-19 KOs)' }, { value: '1024', label: 'Brilliant (1-19 KOs) + Charm' }, { value: '2048', label: 'Brilliant (20-49 KOs)' }, { value: '1024', label: 'Brilliant (20-49 KOs) + Charm' }, { value: '1365', label: 'Brilliant (50-99 KOs)' }, { value: '819', label: 'Brilliant (50-99 KOs) + Charm' }, { value: '1024', label: 'Brilliant (100-199 KOs)' }, { value: '683', label: 'Brilliant (100-199 KOs) + Charm' }, { value: '819', label: 'Brilliant (200-299 KOs)' }, { value: '585', label: 'Brilliant (200-299 KOs) + Charm' }, { value: '683', label: 'Brilliant (300-499 KOs)' }, { value: '512', label: 'Brilliant (300-499 KOs) + Charm' }, { value: '585', label: 'Brilliant (500+ KOs)' }, { value: '455', label: 'Brilliant (500+ KOs) + Charm' }, { value: '683', label: 'Masuda Method' }, { value: '512', label: 'Masuda Method + Charm' }, { value: '300', label: 'Dynamax Adventures' }, { value: '100', label: 'BEST: Dynamax Adventures + Charm' } ], 'gen8-bdsp': [ { value: '4096', label: 'Random Encounter' }, { value: '683', label: 'Masuda Method' }, { value: '512', label: 'Masuda + Shiny Charm' }, { value: '99', label: 'BEST: Poke Radar Chain 40' } ], 'gen7-lgpe': [ { value: '4096', label: 'Base (0-10 Combo)' }, { value: '2048', label: 'Lure Active (0-10)' }, { value: '1365', label: 'Charm (0-10)' }, { value: '1024', label: 'Lure + Charm (0-10)' }, { value: '1024', label: '11-20 Combo' }, { value: '819', label: '11-20 Combo + Lure' }, { value: '683', label: '11-20 Combo + Charm' }, { value: '585', label: '11-20 + Lure + Charm' }, { value: '512', label: '21-30 Combo' }, { value: '455', label: '21-30 Combo + Lure' }, { value: '410', label: '21-30 Combo + Charm' }, { value: '372', label: '21-30 + Lure + Charm' }, { value: '341', label: '31+ Combo' }, { value: '315', label: '31+ Combo + Lure' }, { value: '293', label: '31+ Combo + Charm' }, { value: '273', label: 'BEST: 31+ Combo + Lure + Charm' } ], 'gen7': [ { value: '4096', label: 'Random Encounter' }, { value: '1365', label: 'Shiny Charm' }, { value: '683', label: 'Masuda Method' }, { value: '512', label: 'Masuda + Charm' }, { value: '315', label: 'SOS Chain 30+' }, { value: '273', label: 'SOS Chain 30+ + Charm' }, { value: '100', label: 'Ultra Wormhole Legendary' }, { value: '8192', label: 'Gen I Transfer' } ], 'gen6': [ { value: '4096', label: 'Random Encounter' }, { value: '1365', label: 'Shiny Charm' }, { value: '683', label: 'Masuda Method' }, { value: '512', label: 'Masuda + Charm' }, { value: '819', label: 'Horde Encounter' }, { value: '273', label: 'Horde + Charm' }, { value: '819', label: 'Friend Safari' }, { value: '585', label: 'Friend Safari + Charm' }, { value: '100', label: 'Chain Fishing 20+' }, { value: '96', label: 'Chain Fishing 20+ + Charm' }, { value: '100', label: 'Poke Radar Chain 40' }, { value: '476', label: 'DexNav Search Lvl 999' }, { value: '173', label: 'DexNav 999 + Charm' }, { value: '99', label: 'DexNav Chain 50' }, { value: '73', label: 'DexNav Chain 50 + Charm' }, { value: '56', label: 'DexNav Chain 100' }, { value: '46', label: 'BEST: DexNav Chain 100 + Charm' } ], 'gen5': [ { value: '8192', label: 'Random Encounter' }, { value: '2731', label: 'Shiny Charm' }, { value: '1365', label: 'Masuda Method' }, { value: '1024', label: 'BEST: Masuda + Charm' } ], 'gen4': [ { value: '8192', label: 'Random Encounter' }, { value: '1638', label: 'Masuda Method' }, { value: '200', label: 'BEST: Poke Radar Chain 40' } ], 'gen3': [ { value: '8192', label: 'Random Encounter (1/8192)' } ], 'gen2': [ { value: '8192', label: 'Random Encounter' }, { value: '64', label: 'Breeding w/ Shiny Parent' }, { value: '14', label: 'Odd Egg (International)' }, { value: '50', label: 'Odd Egg (Japanese)' } ] };

        function updateMethodOptions() {
            const gen = generationEl.value;
            const methods = huntMethods[gen] || [];
            methodEl.innerHTML = methods.map(m => `<option value="${m.value}">${m.label}</option>`).join('');
            calculateOdds();
        }

        async function init() {
            await loadPokemonList();
            await loadPokemonData(currentPokemon.name);
            calculateOdds();
            loadHistory();
        }

        async function loadPokemonList() {
            try {
                const response = await fetch('https://pokeapi.co/api/v2/pokemon?limit=1025');
                const data = await response.json();
                allPokemon = data.results.map((p, idx) => ({ name: p.name, id: idx + 1, url: p.url }));
                renderPokemonList(allPokemon);
            } catch (error) {
                listEl.innerHTML = '<div class="loading">ERROR LOADING POKEMON.</div>';
            }
        }

        function renderPokemonList(pokemon) {
            listEl.innerHTML = pokemon.map(p => `
                <div class="pokemon-item ${p.name === currentPokemon.name ? 'selected' : ''}" data-name="${p.name}">
                    <span>${capitalize(p.name)}</span>
                    <span>#${String(p.id).padStart(3, '0')}</span>
                </div>
            `).join('');

            document.querySelectorAll('.pokemon-item').forEach(item => {
                item.addEventListener('click', () => {
                    selectPokemon(item.dataset.name);
                });
            });
        }

        async function loadPokemonData(name) {
            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${name}`);
                const data = await response.json();
                currentPokemon = { name: data.name, id: data.id };
                spriteEl.src = data.sprites.front_shiny || data.sprites.front_default;
                nameEl.textContent = capitalize(data.name);
                idEl.textContent = `#${String(data.id).padStart(3, '0')}`;
                updateBadges(data.name);
            } catch (error) {
                console.error('Failed to load Pokemon:', error);
            }
        }

        function updateBadges(pokemonName) {
            let badges = '';
            if (shinyLockedPokemon[pokemonName]) { badges += `<div class="badge badge-danger">LOCKED!</div>`; }
            if (gen9ZAStaticLocks.includes(pokemonName) || gen9SVStaticLocks.includes(pokemonName)) { badges += `<div class="badge badge-warning">STATIC LOCK</div>`; }
            if (gen9SVTrades.includes(pokemonName) || gen9TealMaskGifts.includes(pokemonName) || gen9IndigoDiskTrades.includes(pokemonName)) { badges += `<div class="badge badge-warning">GIFT/TRADE LOCK</div>`; }
            if (gen9SevenStarRaids.includes(pokemonName)) { badges += `<div class="badge badge-info">RAID LOCK</div>`; }
            badgesEl.innerHTML = badges;
        }

        function selectPokemon(name) {
            if (currentPokemon.name === name) return;
            loadPokemonData(name);
            const currentSelected = listEl.querySelector('.pokemon-item.selected');
            if (currentSelected) { currentSelected.classList.remove('selected'); }
            const newSelected = listEl.querySelector(`.pokemon-item[data-name="${name}"]`);
            if (newSelected) { newSelected.classList.add('selected'); }
        }

        searchEl.addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const filtered = allPokemon.filter(p => p.name.includes(search) || String(p.id).includes(search));
            renderPokemonList(filtered);
        });

        function calculateOdds() {
            const odds = parseFloat(methodEl.value);
            if (isNaN(odds) || odds <= 0) return;
            oddsRateEl.textContent = `1/${Math.round(odds)}`;
            const prob = 1 - Math.pow(1 - (1 / odds), encounterCount);
            oddsCumulativeEl.textContent = `${(prob * 100).toFixed(2)}%`;
            const median = Math.ceil(Math.log(0.5) / Math.log(1 - (1 / odds)));
            oddsMedianEl.textContent = `${median.toLocaleString()}`;
            updateOddsAlerts(prob, median);
        }

        function updateOddsAlerts(probability, median) {
            let alerts = '';
            if (encounterCount > median * 2) { alerts += `<div class="alert alert-danger">WARNING: ${ (encounterCount / median).toFixed(1) }X OVER MEDIAN</div>`; } 
            else if (encounterCount > median) { alerts += `<div class="alert alert-warning">PAST 50% THRESHOLD</div>`; }
            oddsAlertsEl.innerHTML = alerts;
        }

        function incrementCounter() {
            encounterCount++;
            counterEl.textContent = encounterCount.toLocaleString();
            calculateOdds();
        }

        document.getElementById('reset-btn').addEventListener('click', () => {
            if (confirm('ARE YOU SURE?')) {
                encounterCount = 0;
                counterEl.textContent = '0';
                stopTimer();
                resetHuntTimer();
                calculateOdds();
            }
        });

        document.getElementById('increment-btn').addEventListener('click', incrementCounter);

        function startTimer() {
            const interval = parseInt(timerIntervalEl.value, 10);
            if (isNaN(interval) || interval < 1) return;
            stopTimer();
            incrementCounter(); 
            timerInterval = setInterval(incrementCounter, interval * 1000);
            document.getElementById('start-timer-btn').disabled = true;
            document.getElementById('stop-timer-btn').disabled = false;
        }

        function stopTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            document.getElementById('start-timer-btn').disabled = false;
            document.getElementById('stop-timer-btn').disabled = true;
        }

        document.getElementById('start-timer-btn').addEventListener('click', startTimer);
        document.getElementById('stop-timer-btn').addEventListener('click', stopTimer);

        document.getElementById('save-hunt-btn').addEventListener('click', () => {
            if (encounterCount === 0) {
                showMessage('NO ENCOUNTERS TO SAVE!', 'error');
                return;
            }
            const hunt = { pokemon: currentPokemon.name, id: currentPokemon.id, count: encounterCount, method: methodEl.options[methodEl.selectedIndex].text, odds: methodEl.value, date: new Date().toISOString() };
            huntHistory.unshift(hunt);
            if (huntHistory.length > 50) huntHistory.pop();
            saveHistory();
            renderHistory();
            showMessage(`SAVED HUNT!`);
            encounterCount = 0;
            counterEl.textContent = '0';
            stopTimer();
            resetHuntTimer();
            calculateOdds();
        });

        function saveHistory() {
            try { localStorage.setItem('shiny-hunt-history', JSON.stringify(huntHistory)); } 
            catch (e) { console.error('Could not save history:', e); }
        }

        function loadHistory() {
            try {
                const saved = localStorage.getItem('shiny-hunt-history');
                if (saved) {
                    huntHistory = JSON.parse(saved);
                    renderHistory();
                }
            } catch (e) { console.error('Could not load history:', e); }
        }

        function renderHistory() {
            if (huntHistory.length === 0) {
                historyEl.innerHTML = '<p>NO SAVED HUNTS.</p>';
                return;
            }
            historyEl.innerHTML = `<div class="history-list">${huntHistory.map((h, index) => {
                const date = new Date(h.date);
                const dateStr = date.toLocaleDateString();
                return `
                    <div class="history-item">
                        <div class="history-item-info">
                            <div class="history-pokemon">${capitalize(h.pokemon)}</div>
                            <div style="font-size: 0.6rem; color: #656565; margin-top: 4px;">${dateStr}</div>
                        </div>
                        <div class="history-count">${h.count.toLocaleString()}</div>
                        <button class="delete-hunt-btn" data-index="${index}" title="Delete Hunt">X</button>
                    </div>`;
            }).join('')}</div>`;
        }
        
        historyEl.addEventListener('click', function(e) {
            if (e.target.classList.contains('delete-hunt-btn')) {
                const index = parseInt(e.target.dataset.index, 10);
                if (confirm(`DELETE THIS HUNT?`)) {
                    huntHistory.splice(index, 1);
                    saveHistory();
                    renderHistory();
                }
            }
        });

        function showMessage(text, type = 'success') {
            const existingMsg = document.querySelector('.success-message');
            if (existingMsg) existingMsg.remove();

            const msg = document.createElement('div');
            msg.className = 'success-message';
            msg.textContent = text;
            if (type === 'error') {
                msg.style.background = 'var(--red)';
                msg.style.color = '#fff';
            }
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 2000);
        }

        function capitalize(str) {
            if (!str) return '';
            return str.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        function updateHuntTimerDisplay() {
            const hours = Math.floor(huntTimeSeconds / 3600);
            const minutes = Math.floor((huntTimeSeconds % 3600) / 60);
            const seconds = huntTimeSeconds % 60;
            huntTimerDisplayEl.textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function startHuntTimer() {
            if (isHuntTimerRunning) return;
            isHuntTimerRunning = true;
            huntTimerInterval = setInterval(() => {
                huntTimeSeconds++;
                updateHuntTimerDisplay();
            }, 1000);
            startHuntTimerBtn.disabled = true;
            pauseHuntTimerBtn.disabled = false;
        }

        function pauseHuntTimer() {
            if (!isHuntTimerRunning) return;
            isHuntTimerRunning = false;
            clearInterval(huntTimerInterval);
            startHuntTimerBtn.disabled = false;
            pauseHuntTimerBtn.disabled = true;
        }

        function resetHuntTimer() {
            pauseHuntTimer();
            huntTimeSeconds = 0;
            updateHuntTimerDisplay();
        }

        startHuntTimerBtn.addEventListener('click', startHuntTimer);
        pauseHuntTimerBtn.addEventListener('click', pauseHuntTimer);
        resetHuntTimerBtn.addEventListener('click', resetHuntTimer);

        methodEl.addEventListener('change', calculateOdds);
        generationEl.addEventListener('change', updateMethodOptions);

        updateMethodOptions();
        init();
    </script>
</body>
</html>